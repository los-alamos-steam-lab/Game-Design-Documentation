

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Godot Template: Save Game &mdash; Game Design 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/explore.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/nbsphinx.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/js/custom.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Godot Template: Entity Class" href="3-entity.html" />
    <link rel="prev" title="Godot Template: Understanding the Camera" href="1-camera.html" /> 
</head>

<body class="wy-body-for-nav">

  
<nav id="explore-links">
    <a class='caption' href="https://lasteamlab.com/">
        Los Alamos STEAM Lab
    </a>

    <!-- <ul>
        <li>
            <a>Get Started</a>
            <ul>
                <li><a href="https://docs.dask.org/en/latest/install.html"> Install </a></li>
                <li><a href="https://examples.dask.org"> Examples </a></li>
                <li><a href="https://github.com/dask/dask-tutorial"> Tutorial </a></li>
                <li><a href="https://docs.dask.org/en/latest/why.html"> Why Dask? </a></li>
                <li><a href="https://stories.dask.org/en/latest"> Use Cases </a></li>
                <li><a href="https://www.youtube.com/watch?v=RA_2qdipVng&list=PLRtz5iA93T4PQvWuoMnIyEIz1fXiJ5Pri"> Talks
                    </a></li>
                <li><a href="https://mybinder.org/v2/gh/dask/dask-examples/master?urlpath=lab"> Try Online </a></li>
                <li><a href="https://dask.org/slides"> Slides </a></li>
            </ul>
        </li>

        <li>
            <a href="">Algorithms</a>
            <ul>
                <li><a href="https://docs.dask.org/en/latest/array.html">Arrays</a></li>
                <li><a href="https://docs.dask.org/en/latest/dataframe.html">Dataframes</a></li>
                <li><a href="https://docs.dask.org/en/latest/bag.html">Bags</a></li>
                <li><a href="https://docs.dask.org/en/latest/delayed.html">Delayed (custom)</a></li>
                <li><a href="https://docs.dask.org/en/latest/futures.html">Futures (real-time)</a></li>
                <li><a href="http://ml.dask.org">Machine Learning</a></li>
                <li><a href="https://xarray.pydata.org/en/latest/">XArray</a></li>
            </ul>
        </li>

        <li>
            <a href="https://docs.dask.org/en/latest/setup.html">Setup</a>
            <ul>
                <li><a href="https://docs.dask.org/en/latest/setup/single-machine.html"> Local </a></li>
                <li><a href="https://docs.dask.org/en/latest/setup/cloud.html"> Cloud </a></li>
                <li><a href="https://docs.dask.org/en/latest/setup/hpc.html"> HPC </a></li>
                <li><a href="https://kubernetes.dask.org/en/latest/"> Kubernetes </a></li>
                <li><a href="https://yarn.dask.org/en/latest/"> Hadoop / Yarn </a></li>
            </ul>
        </li>

        <li>
            <a>Community</a>
            <ul>
                <li><a href="http://docs.dask.org/en/latest/support.html">Ask for Help</a></li>
                <li><a href="https://github.com/dask">Github</a></li>
                <li><a href="https://stackoverflow.com/questions/tagged/dask">Stack Overflow</a></li>
                <li><a href="https://twitter.com/dask_dev">Twitter</a></li>
                <li><a href="https://blog.dask.org/"> Developer Blog </a></li>
                <li><a href="https://youtube.com/c/dask-dev"> YouTube Channel </a></li>
            </ul>
        </li>
    </ul> -->

</nav>

  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #6200ad" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Game Design
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
<div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../godot.html">Godot Game Engine</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../getting-started.html">Getting Started with Godot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started.html#downloading">Downloading</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started.html#setting-up-the-environment">Setting up the Environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started.html#comment-blocks">Comment Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started.html#indenting">Indenting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../lessons/index.html">Top Down RPG: Lessons</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../lessons/1-player-movement.html">1: Player Movement</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../lessons/1-player-movement.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/1-player-movement.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/1-player-movement.html#video">Video</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/1-player-movement.html#code">Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lessons/2-animations.html">2: Walk and Push Animations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../lessons/2-animations.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/2-animations.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/2-animations.html#video">Video</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/2-animations.html#resources">Resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/2-animations.html#code">Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lessons/3-entity-class.html">3: Entity Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../lessons/3-entity-class.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/3-entity-class.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/3-entity-class.html#video">Video</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/3-entity-class.html#code">Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lessons/4-knockback.html">4: Knockback</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../lessons/4-knockback.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/4-knockback.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/4-knockback.html#video">Video</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/4-knockback.html#code">Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lessons/5-items.html">5: Item Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../lessons/5-items.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/5-items.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/5-items.html#video">Video</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/5-items.html#code">Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lessons/6-enemy-health.html">6: Enemy Health</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../lessons/6-enemy-health.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/6-enemy-health.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/6-enemy-health.html#video">Video</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/6-enemy-health.html#resources">Resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/6-enemy-health.html#code">Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lessons/7-screen-scrolling.html">7: Basic Screen Scorlling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../lessons/7-screen-scrolling.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/7-screen-scrolling.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/7-screen-scrolling.html#video">Video</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/7-screen-scrolling.html#resources">Resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/7-screen-scrolling.html#code">Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lessons/8-object-placer.html">8: Object Placer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../lessons/8-object-placer.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/8-object-placer.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/8-object-placer.html#video">Video</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/8-object-placer.html#code">Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lessons/9-keys.html">9: Keys and Locked Doors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../lessons/9-keys.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/9-keys.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/9-keys.html#video">Video</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/9-keys.html#resources">Resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/9-keys.html#code">Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lessons/10-heart-ui.html">10: Heart UI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../lessons/10-heart-ui.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/10-heart-ui.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/10-heart-ui.html#video">Video</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/10-heart-ui.html#resources">Resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/10-heart-ui.html#code">Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lessons/11-heart-pickups.html">11: Heart Pickups</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../lessons/11-heart-pickups.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/11-heart-pickups.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/11-heart-pickups.html#video">Video</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lessons/11-heart-pickups.html#code">Code</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Top Down RPG: Template</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="1-camera.html">1: Camera</a><ul>
<li class="toctree-l4"><a class="reference internal" href="1-camera.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="1-camera.html#scene-tree">Scene Tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="1-camera.html#exports">Exports</a></li>
<li class="toctree-l4"><a class="reference internal" href="1-camera.html#signals">Signals</a></li>
<li class="toctree-l4"><a class="reference internal" href="1-camera.html#code">Code</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2: Save Game</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#main-scene">Main Scene</a></li>
<li class="toctree-l4"><a class="reference internal" href="#map-areas">Map Areas</a></li>
<li class="toctree-l4"><a class="reference internal" href="#code">Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="3-entity.html">3: Entity Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="3-entity.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="3-entity.html#scene-tree">Scene Tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="3-entity.html#exports">Exports</a></li>
<li class="toctree-l4"><a class="reference internal" href="3-entity.html#ready">_ready()</a></li>
<li class="toctree-l4"><a class="reference internal" href="3-entity.html#loops">Loops</a></li>
<li class="toctree-l4"><a class="reference internal" href="3-entity.html#use-item">Use item</a></li>
<li class="toctree-l4"><a class="reference internal" href="3-entity.html#code">Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="4-enemy-drops.html">4: Enemy Drops</a><ul>
<li class="toctree-l4"><a class="reference internal" href="4-enemy-drops.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="4-enemy-drops.html#exports">Exports</a></li>
<li class="toctree-l4"><a class="reference internal" href="4-enemy-drops.html#normalization">Normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="4-enemy-drops.html#enemy-death">Enemy Death</a></li>
<li class="toctree-l4"><a class="reference internal" href="4-enemy-drops.html#code">Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="4-enemy-drops.html#id1">Code</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/index.html">Top Down RPG: Making it Your Own</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/1-map-area.html">1: Making a New Map Area</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/1-map-area.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/1-map-area.html#drawing-the-scene">Drawing the Scene</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/1-map-area.html#placing-items-and-entities">Placing Items and Entities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting-started/1-map-area.html#playing-the-scene">Playing the Scene</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../assets/assets.html">Asset Creation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../assets/apps/apps.html">Graphics Applications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../assets/apps/inkscape.html">Inkscape</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../assets/apps/inkscape.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../assets/apps/inkscape.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../assets/apps/inkscape.html#more-coming">More Coming</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../assets/apps/gimp.html">GIMP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../assets/apps/gimp.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../assets/apps/gimp.html#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../assets/apps/gimp.html#more-coming">More Coming</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../assets/apps/pixel-editors.html">Pixel Editors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../assets/apps/pixel-editors.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../assets/apps/pixel-editors.html#online-apps">Online Apps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../assets/apps/pixel-editors.html#more-coming">More Coming</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
  
    <img src="../../../_static/images/mouse-hi-res.png" />
</div>

      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Game Design</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../godot.html">Godot Game Engine</a> &raquo;</li>
        
          <li><a href="index.html">Top Down RPG: Template</a> &raquo;</li>
        
      <li>Godot Template: Save Game</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/godot/RPG/template/2-save-game.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="godot-template-save-game">
<h1>Godot Template: Save Game<a class="headerlink" href="#godot-template-save-game" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Saving and loading is a pretty important part of an RPG.  This game does not have a
save screen, but does load the game upon start and save it upon scene or room change.
There is a main save file, as well as a save file for each map area.</p>
<p>Worth noting is that this template saves files to the <a class="reference external" href="res://">res://</a> directory for easier access.
This will need to be updated to user:// at deployment time.</p>
<p>Much of the save game process came directly from the Godot docs:
<a class="reference external" href="https://docs.godotengine.org/en/stable/tutorials/io/saving_games.html">https://docs.godotengine.org/en/stable/tutorials/io/saving_games.html</a></p>
</div>
<div class="section" id="main-scene">
<h2>Main Scene<a class="headerlink" href="#main-scene" title="Permalink to this headline">¶</a></h2>
<div class="section" id="saving">
<h3>Saving<a class="headerlink" href="#saving" title="Permalink to this headline">¶</a></h3>
<p>When a screen change is started, <a class="reference internal" href="#main-save-game">Main.save_game()</a> is called.</p>
<ul class="simple">
<li><p>If there is a current_area and include_area is true (default)
then call the area’s save game.</p></li>
<li><p>Call <a class="reference internal" href="#main-save">Main.save()</a> in order to save details like which map area
is loaded and where the player should start in it as well as player
stats.</p></li>
<li><p>Go through all of nodes in group ‘persist.  If they are not empty,
have the current scene as their parent, and have a save method,
then call it (in our template, this only affects the player).</p></li>
<li><dl class="simple">
<dt>They should return a dictionary that includes:</dt><dd><ul>
<li><p>“filename” : get_filename()</p></li>
<li><p>“parent” : get_parent().get_path()</p></li>
<li><p>“pos_x” : position.x</p></li>
<li><p>“pos_y” : position.y</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Store everything in the save file and close it.  Each dictionary is
converted to json and written as a single line in the file.</p></li>
</ul>
</div>
<div class="section" id="loading">
<h3>Loading<a class="headerlink" href="#loading" title="Permalink to this headline">¶</a></h3>
<p>When the game starts we load the save game.</p>
<p>Note that in <a class="reference internal" href="#main-ready">Main._ready()</a> we make use of yield(get_tree(), “idle_frame”)
in order to prevent race conditions. After the first yield, call <a class="reference internal" href="#main-load-game">Main.load_game()</a></p>
<ul class="simple">
<li><p>If there’s no save file, leave.</p></li>
<li><p>Get all of the nodes in group ‘persist’.  If they’re not the player and
have a save game, then delete them.  Basically, if we didn’t save them it is
because the player destroyed them (enemies and locked doors) or picked them up
(keys).  If we did save them, we’ll load them in a moment.</p></li>
<li><p>Open the save game and read it line by line.</p></li>
<li><p>If it is empty, ignore it.</p></li>
<li><p>If it is for the player, call Player.load_dict()</p></li>
<li><p>If it is for the current file (Main) save the line.  We’ll get to it at the
end.</p></li>
<li><p>Otherwise, load the new scene and set its position. If it has a load_dict()
call it, otherwise assume each dictionary key has a corresponding variable
and just assign it.</p></li>
<li><p>If we saved the data for the current file (Main) load it now.  This can overwrite
the player position, so we wanted to wait until the end.</p></li>
<li><p>If the initial_area_path was set, then load the current_area.</p></li>
</ul>
</div>
</div>
<div class="section" id="map-areas">
<h2>Map Areas<a class="headerlink" href="#map-areas" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>Saving<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Map Areas are saved during screen changes via Main.save_game() and teleports
before they are deleted.</p>
<p>These save routines are very similar to the last stage of Main.save_game().</p>
<ul class="simple">
<li><p>Go through all of nodes in group ‘persist.  If they are not empty,
have the current scene as their parent, and have a save method,
then call it.  This will include enemies and objects spawned by the
object placer. This will not include any grandchildren of the area.</p></li>
<li><dl class="simple">
<dt>They should return a dictionary that includes:</dt><dd><ul>
<li><p>“filename” : get_filename()</p></li>
<li><p>“parent” : get_parent().get_path()</p></li>
<li><p>“pos_x” : position.x</p></li>
<li><p>“pos_y” : position.y</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Store everything in the save file and close it.  Each dictionary is
converted to json and written as a single line in the file.</p></li>
</ul>
</div>
<div class="section" id="id2">
<h3>Loading<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Map Areas are loaded when the scene is loaded (usually when the game loads
or the player teleports.</p>
<p>Note that in <a class="reference internal" href="#maparea-ready">maparea._ready()</a> we
make use of yield(get_tree(), “idle_frame”) in order to prevent race
conditions. We need the object placer to finish loading scenes before we delete
them. After the yield, call <a class="reference internal" href="#maparea-load-maparea">maparea.load_maparea()</a>.</p>
<p>These load routines are very similar to the last stage of Main.save_game().</p>
<ul class="simple">
<li><p>If there’s no save file, leave.</p></li>
<li><p>Get all of the nodes in group ‘persist’.  If they have the current map area as
a parent, delete them.  Basically, if we didn’t save them it is
because the player destroyed them (enemies and locked doors) or picked them up
(keys).  If we did save them, we’ll load them in a moment.</p></li>
<li><p>Open the save game and read it line by line.</p></li>
<li><p>If it is empty, ignore it.</p></li>
<li><p>Otherwise, load the new scene and set its position. If it has a load_dict()
call it, otherwise assume each dictionary key has a corresponding variable
and just assign it.</p></li>
</ul>
</div>
</div>
<div class="section" id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h2>
<div class="section" id="main-save-game">
<h3>Main.save_game()<a class="headerlink" href="#main-save-game" title="Permalink to this headline">¶</a></h3>
<div class="highlight-gdscript notranslate"><div class="highlight"><pre><span></span><span class="k">func</span> <span class="n">save_game</span><span class="p">(</span><span class="n">include_area</span> <span class="o">=</span> <span class="bp">true</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">current_area</span> <span class="ow">and</span> <span class="n">include_area</span><span class="p">:</span>
        <span class="n">current_area</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s2">&quot;save_maparea&quot;</span><span class="p">)</span>

    <span class="k">var</span> <span class="n">save_game</span> <span class="o">=</span> <span class="n">File</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
    <span class="n">save_game</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">SAVE_FILE</span><span class="p">,</span> <span class="n">File</span><span class="o">.</span><span class="n">WRITE</span><span class="p">)</span>

    <span class="c1"># Save stats</span>
    <span class="k">var</span> <span class="n">node_data</span> <span class="o">=</span> <span class="n">save</span><span class="p">()</span>
    <span class="n">save_game</span><span class="o">.</span><span class="n">store_line</span><span class="p">(</span><span class="n">to_json</span><span class="p">(</span><span class="n">node_data</span><span class="p">))</span>

    <span class="k">var</span> <span class="n">save_nodes</span> <span class="o">=</span> <span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">get_nodes_in_group</span><span class="p">(</span><span class="s2">&quot;persist&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">save_nodes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--persistent node &#39;</span><span class="si">%s</span><span class="s2">&#39; is not an instanced scene, skipped&quot;</span> <span class="o">%</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span> <span class="o">==</span> <span class="n">current_area</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--persistent node &#39;</span><span class="si">%s</span><span class="s2">&#39; is in the current map area, skipped&quot;</span> <span class="o">%</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="o">!</span><span class="n">node</span><span class="o">.</span><span class="n">has_method</span><span class="p">(</span><span class="s2">&quot;save&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--persistent node &#39;</span><span class="si">%s</span><span class="s2">&#39; is missing a save() function, skipped&quot;</span> <span class="o">%</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">node_data</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s2">&quot;save&quot;</span><span class="p">)</span>
        <span class="n">save_game</span><span class="o">.</span><span class="n">store_line</span><span class="p">(</span><span class="n">to_json</span><span class="p">(</span><span class="n">node_data</span><span class="p">))</span>

    <span class="n">save_game</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="main-save">
<h3>Main.save()<a class="headerlink" href="#main-save" title="Permalink to this headline">¶</a></h3>
<div class="highlight-gdscript notranslate"><div class="highlight"><pre><span></span><span class="k">func</span> <span class="n">save</span><span class="p">():</span>
    <span class="k">var</span> <span class="n">save_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;filename&quot;</span> <span class="p">:</span> <span class="n">get_filename</span><span class="p">(),</span>
        <span class="s2">&quot;inital_area_path&quot;</span> <span class="p">:</span> <span class="n">current_area</span><span class="o">.</span><span class="n">get_filename</span><span class="p">(),</span>
        <span class="s2">&quot;player_startx&quot;</span> <span class="p">:</span> <span class="n">current_area</span><span class="o">.</span><span class="n">player_start</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
        <span class="s2">&quot;player_starty&quot;</span> <span class="p">:</span> <span class="n">current_area</span><span class="o">.</span><span class="n">player_start</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
        <span class="s2">&quot;player_start_spritedir&quot;</span> <span class="p">:</span> <span class="n">current_area</span><span class="o">.</span><span class="n">player_start_spritedir</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">save_dict</span>
</pre></div>
</div>
</div>
<div class="section" id="main-ready">
<h3>Main._ready()<a class="headerlink" href="#main-ready" title="Permalink to this headline">¶</a></h3>
<div class="highlight-gdscript notranslate"><div class="highlight"><pre><span></span><span class="k">func</span> <span class="n">_ready</span><span class="p">():</span>
    <span class="n">player</span> <span class="o">=</span> <span class="n">get_node</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>

    <span class="nb">yield</span><span class="p">(</span><span class="n">get_tree</span><span class="p">(),</span> <span class="s2">&quot;idle_frame&quot;</span><span class="p">)</span>
    <span class="n">load_game</span><span class="p">()</span>

    <span class="nb">yield</span><span class="p">(</span><span class="n">get_tree</span><span class="p">(),</span> <span class="s2">&quot;idle_frame&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="o">!</span><span class="n">current_area</span><span class="p">:</span>
        <span class="n">current_area</span> <span class="o">=</span> <span class="n">instance_area</span><span class="p">(</span><span class="n">inital_area_path</span><span class="p">)</span>
        <span class="n">player</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">current_area</span><span class="o">.</span><span class="n">player_start</span>
        <span class="n">player</span><span class="o">.</span><span class="n">spritedir</span> <span class="o">=</span> <span class="n">current_area</span><span class="o">.</span><span class="n">player_start_spritedir</span>

    <span class="n">camera</span> <span class="o">=</span> <span class="n">get_node</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>
    <span class="n">camera</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;screen_change_completed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;screen_change_completed&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="main-load-game">
<h3>Main.load_game()<a class="headerlink" href="#main-load-game" title="Permalink to this headline">¶</a></h3>
<div class="highlight-gdscript notranslate"><div class="highlight"><pre><span></span><span class="k">func</span> <span class="n">load_game</span><span class="p">():</span>
    <span class="k">var</span> <span class="n">save_game</span> <span class="o">=</span> <span class="n">File</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
    <span class="k">var</span> <span class="n">local_save_data</span> <span class="o">=</span> <span class="nb nb-Type">null</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">save_game</span><span class="o">.</span><span class="n">file_exists</span><span class="p">(</span><span class="n">SAVE_FILE</span><span class="p">):</span>
        <span class="k">return</span> <span class="c1"># Error! We don&#39;t have a save to load.</span>

    <span class="c1"># We need to revert the game state so we&#39;re not cloning objects</span>
    <span class="c1"># during loading. This will vary wildly depending on the needs of a</span>
    <span class="c1"># project, so take care with this step.</span>
    <span class="c1"># For our example, we will accomplish this by deleting saveable objects.</span>
    <span class="k">var</span> <span class="n">save_nodes</span> <span class="o">=</span> <span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">get_nodes_in_group</span><span class="p">(</span><span class="s2">&quot;persist&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">save_nodes</span><span class="p">:</span>
        <span class="c1"># if it is the player (our current) node we can&#39;t delete it</span>
        <span class="c1"># we also don&#39;t want to delete it if it doesn&#39;t have a save</span>
        <span class="c1"># function, because we probably haven&#39;t finished setting it up</span>
        <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">get_filename</span><span class="p">()</span> <span class="o">==</span> <span class="n">node</span><span class="o">.</span><span class="n">get_filename</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--persistent node &#39;</span><span class="si">%s</span><span class="s2">&#39; is the Player node, skipped&quot;</span> <span class="o">%</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="o">!</span><span class="n">node</span><span class="o">.</span><span class="n">has_method</span><span class="p">(</span><span class="s2">&quot;save&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--persistent node &#39;</span><span class="si">%s</span><span class="s2">&#39; is missing a save() function, skipped&quot;</span> <span class="o">%</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">node</span><span class="o">.</span><span class="n">queue_free</span><span class="p">()</span>


    <span class="c1"># Load the file line by line and process that dictionary to restore</span>
    <span class="c1"># the object it represents.</span>
    <span class="n">save_game</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">SAVE_FILE</span><span class="p">,</span> <span class="n">File</span><span class="o">.</span><span class="n">READ</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">save_game</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">save_game</span><span class="o">.</span><span class="n">get_len</span><span class="p">():</span>
        <span class="c1"># Get the saved dictionary from the next line in the save file</span>
        <span class="k">var</span> <span class="n">node_data</span> <span class="o">=</span> <span class="n">parse_json</span><span class="p">(</span><span class="n">save_game</span><span class="o">.</span><span class="n">get_line</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">node_data</span> <span class="o">==</span> <span class="nb nb-Type">null</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># If it is the player node we&#39;re not creating a new instance</span>
        <span class="k">if</span> <span class="n">player</span><span class="o">.</span><span class="n">get_filename</span><span class="p">()</span> <span class="o">==</span> <span class="n">node_data</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]:</span>
            <span class="n">player</span><span class="o">.</span><span class="n">load_dict</span><span class="p">(</span><span class="n">node_data</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="c1"># If it is the local file then save the line to be loaded at the</span>
        <span class="c1"># end.  We&#39;re not loading it now because we want to overwrite player</span>
        <span class="c1"># position.</span>
        <span class="k">if</span> <span class="n">get_filename</span><span class="p">()</span> <span class="o">==</span> <span class="n">node_data</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]:</span>
            <span class="n">local_save_data</span> <span class="o">=</span> <span class="n">node_data</span>
            <span class="k">continue</span>

        <span class="c1"># Firstly, we need to create the object and add it to the tree and set its position.</span>
        <span class="k">var</span> <span class="n">new_object</span> <span class="o">=</span> <span class="nb">load</span><span class="p">(</span><span class="n">node_data</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
        <span class="n">get_node</span><span class="p">(</span><span class="n">node_data</span><span class="p">[</span><span class="s2">&quot;parent&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">new_object</span><span class="p">)</span>
        <span class="n">new_object</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="nb nb-Type">Vector2</span><span class="p">(</span><span class="n">node_data</span><span class="p">[</span><span class="s2">&quot;pos_x&quot;</span><span class="p">],</span> <span class="n">node_data</span><span class="p">[</span><span class="s2">&quot;pos_y&quot;</span><span class="p">])</span>

        <span class="c1"># If it had its own load method, use it</span>
        <span class="c1"># Otherwise set the remaining variables based on key names</span>
        <span class="k">if</span> <span class="n">new_object</span><span class="o">.</span><span class="n">has_method</span><span class="p">(</span><span class="s2">&quot;load_dict&quot;</span><span class="p">):</span>
            <span class="n">new_object</span><span class="o">.</span><span class="n">load_dict</span><span class="p">(</span><span class="n">node_data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">node_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="s2">&quot;filename&quot;</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="s2">&quot;parent&quot;</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="s2">&quot;pos_x&quot;</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="s2">&quot;pos_y&quot;</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">new_object</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">node_data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="c1"># load the local stats</span>
    <span class="k">if</span> <span class="n">local_save_data</span><span class="p">:</span>
        <span class="n">load_dict</span><span class="p">(</span><span class="n">local_save_data</span><span class="p">)</span>

    <span class="c1"># load the current_area</span>
    <span class="k">if</span> <span class="n">inital_area_path</span><span class="p">:</span>
        <span class="n">current_area</span> <span class="o">=</span> <span class="n">instance_area</span><span class="p">(</span><span class="n">inital_area_path</span><span class="p">)</span>

    <span class="n">save_game</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="maparea-save-maparea">
<h3>maparea.save_maparea()<a class="headerlink" href="#maparea-save-maparea" title="Permalink to this headline">¶</a></h3>
<div class="highlight-gdscript notranslate"><div class="highlight"><pre><span></span><span class="k">func</span> <span class="n">save_maparea</span><span class="p">():</span>
    <span class="k">var</span> <span class="n">save_game</span> <span class="o">=</span> <span class="n">File</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
    <span class="n">save_game</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">SAVE_FILE</span><span class="p">,</span> <span class="n">File</span><span class="o">.</span><span class="n">WRITE</span><span class="p">)</span>

    <span class="k">var</span> <span class="n">save_nodes</span> <span class="o">=</span> <span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">get_nodes_in_group</span><span class="p">(</span><span class="s2">&quot;persist&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">save_nodes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--persistent node &#39;</span><span class="si">%s</span><span class="s2">&#39; is not an instanced scene, skipped&quot;</span> <span class="o">%</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="o">!</span><span class="n">node</span><span class="o">.</span><span class="n">has_method</span><span class="p">(</span><span class="s2">&quot;save&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--persistent node &#39;</span><span class="si">%s</span><span class="s2">&#39; is missing a save() function, skipped&quot;</span> <span class="o">%</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">var</span> <span class="n">node_data</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s2">&quot;save&quot;</span><span class="p">)</span>
            <span class="n">save_game</span><span class="o">.</span><span class="n">store_line</span><span class="p">(</span><span class="n">to_json</span><span class="p">(</span><span class="n">node_data</span><span class="p">))</span>

    <span class="n">save_game</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="maparea-ready">
<h3>maparea._ready()<a class="headerlink" href="#maparea-ready" title="Permalink to this headline">¶</a></h3>
<div class="highlight-gdscript notranslate"><div class="highlight"><pre><span></span><span class="k">func</span> <span class="n">_ready</span><span class="p">():</span>
    <span class="n">SAVE_FILE</span> <span class="o">=</span> <span class="s2">&quot;res://&quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
    <span class="c1"># yield is need to allow the scene to finish loading</span>
    <span class="c1"># before loading the savefile.</span>
    <span class="nb">yield</span><span class="p">(</span><span class="n">get_tree</span><span class="p">(),</span> <span class="s2">&quot;idle_frame&quot;</span><span class="p">)</span>
    <span class="n">load_maparea</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="maparea-load-maparea">
<h3>maparea.load_maparea()<a class="headerlink" href="#maparea-load-maparea" title="Permalink to this headline">¶</a></h3>
<div class="highlight-gdscript notranslate"><div class="highlight"><pre><span></span><span class="k">func</span> <span class="n">load_maparea</span><span class="p">():</span>

    <span class="k">var</span> <span class="n">save_game</span> <span class="o">=</span> <span class="n">File</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">save_game</span><span class="o">.</span><span class="n">file_exists</span><span class="p">(</span><span class="n">SAVE_FILE</span><span class="p">):</span>
        <span class="k">return</span> <span class="c1"># Error! We don&#39;t have a save to load.</span>

    <span class="c1"># We need to revert the game state so we&#39;re not cloning objects</span>
    <span class="c1"># during loading. This will vary wildly depending on the needs of a</span>
    <span class="c1"># project, so take care with this step.</span>
    <span class="c1"># For our example, we will accomplish this by deleting saveable objects.</span>
    <span class="k">var</span> <span class="n">save_nodes</span> <span class="o">=</span> <span class="n">get_tree</span><span class="p">()</span><span class="o">.</span><span class="n">get_nodes_in_group</span><span class="p">(</span><span class="s2">&quot;persist&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">save_nodes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">i</span><span class="o">.</span><span class="n">queue_free</span><span class="p">()</span>

    <span class="c1"># Load the file line by line and process that dictionary to restore</span>
    <span class="c1"># the object it represents.</span>
    <span class="n">save_game</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">SAVE_FILE</span><span class="p">,</span> <span class="n">File</span><span class="o">.</span><span class="n">READ</span><span class="p">)</span>

    <span class="k">while</span> <span class="ow">not</span> <span class="n">save_game</span><span class="o">.</span><span class="n">eof_reached</span><span class="p">():</span>
        <span class="k">var</span> <span class="n">node_data</span> <span class="o">=</span> <span class="n">parse_json</span><span class="p">(</span><span class="n">save_game</span><span class="o">.</span><span class="n">get_line</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">node_data</span> <span class="o">==</span> <span class="nb nb-Type">null</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Firstly, we need to create the object and add it to the tree and set its position.</span>
        <span class="k">var</span> <span class="n">new_object</span> <span class="o">=</span> <span class="nb">load</span><span class="p">(</span><span class="n">node_data</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
        <span class="n">get_node</span><span class="p">(</span><span class="n">node_data</span><span class="p">[</span><span class="s2">&quot;parent&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">new_object</span><span class="p">)</span>
        <span class="n">new_object</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="nb nb-Type">Vector2</span><span class="p">(</span><span class="n">node_data</span><span class="p">[</span><span class="s2">&quot;pos_x&quot;</span><span class="p">],</span> <span class="n">node_data</span><span class="p">[</span><span class="s2">&quot;pos_y&quot;</span><span class="p">])</span>

        <span class="c1"># Now we set the remaining variables.</span>
        <span class="k">if</span> <span class="n">new_object</span><span class="o">.</span><span class="n">has_method</span><span class="p">(</span><span class="s2">&quot;load_dict&quot;</span><span class="p">):</span>
            <span class="n">new_object</span><span class="o">.</span><span class="n">load_dict</span><span class="p">(</span><span class="n">node_data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">node_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="s2">&quot;filename&quot;</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="s2">&quot;parent&quot;</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="s2">&quot;pos_x&quot;</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="s2">&quot;pos_y&quot;</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">new_object</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">node_data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="n">save_game</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="3-entity.html" class="btn btn-neutral float-right" title="Godot Template: Entity Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="1-camera.html" class="btn btn-neutral float-left" title="Godot Template: Understanding the Camera" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Lisabeth Lueninghoener.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>